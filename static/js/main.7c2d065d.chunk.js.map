{"version":3,"sources":["components/sharedGroup.js","components/inputDrawer.js","App.js","utils/cache.js","index.js"],"names":["items","onChange","its","map","val","className","key","uniqueId","data-id","options","group","animation","props","title","visible","v","isHieghtlight","useState","value","setValue","useEffect","placement","onClose","width","onValueChange","code","highlight","languages","yaml","padding","style","fontFamily","fontSize","borderRadius","backgroundColor","color","fileDownload","require","Header","Content","Sider","Footer","RAW_CONFIG","SUB_CONFIG","PROXIES_CONFIG","IS_FLAT_RULESET","CLASHRESTFULAPI","RULE_TYPES","PROXY_KEY","GROUP_KEY","RULE_KEY","localPort","client","create","baseURL","headers","useLocalStorage","initValue","c","str","window","localStorage","getItem","JSON","parse","getCache","setItem","stringify","setCache","useDrawerInput","cacheKey","setVisible","t","App","rawConfig","setRawConfig","setRawDrawerVisible","subsURLs","setSubDrawerVisible","syncBtnLoading","setSyncBtnLoading","groupIndex","setGroupIndex","moreFileterStr","setMoreFilterStr","isLocalMode","setIsLocalMode","get","then","data","status","catch","_","subProxies","setSubProxies","isFlatRuleset","setIsFlatRuleset","clashAPI","setClashAPI","rawObj","setRawObj","a","request","url","resp","OLD_PROXY_KEY","urls","split","filter","test","proxyURL","all","encodeURIComponent","resps","proxies","forEach","index","yml","p","op","concat","notification","error","message","description","stack","groups","rules","finalRules","rule","ps","trim","type","proxy","lines","l","payload","args","includes","res","r","finalProxies","allProxyNames","name","g","entries","idx","fileName","fileContent","method","location","href","put","validateStatus","s","success","info","obj","proxyGroup","open","duration","gs","proxyGroupNames","Item","groupProxies","length","moreProxies","exp","RegExp","theme","mode","selectedKeys","lineHeight","onClick","background","item","height","borderRight","count","overflowCount","offset","order","placeholder","e","target","allowClear","loading","icon","checked","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.7c2d065d.chunk.js","sourcesContent":["import React from 'react'\n\nimport Sortable from 'react-sortablejs';\nimport uniqueId from 'lodash/uniqueId';\n\nexport default function ({ items = [], onChange = () => { } }) {\n  const its = items.map(val => {\n    return (\n      <div className=\"menu-item\" key={uniqueId()} data-id={val}>{val}</div>\n    )\n  });\n\n  return (\n    <Sortable\n      options={{\n        group: 'shared',\n        animation: 150,\n      }}\n      onChange={onChange}\n      className=\"menu\"\n    >\n      {its}\n    </Sortable>\n  );\n}","import React, { useState, useEffect } from 'react'\nimport Editor from 'react-simple-code-editor';\nimport { highlight, languages } from 'prismjs/components/prism-core';\nimport 'prismjs/components/prism-yaml';\nimport 'prismjs/components/prism-json'\nimport 'prismjs/themes/prism-okaidia.css'\nimport { Drawer } from 'antd'\n\n\nexport default function (props) {\n    const { title = \"\", visible = false, onChange, 'value': v, isHieghtlight = true } = props\n    const [value, setValue] = useState(v)\n\n    useEffect(() => {\n        setValue(v)\n    }, [v])\n\n    return (\n        <Drawer\n            title={title}\n            placement=\"right\"\n            onClose={() => onChange(value)}\n            visible={visible}\n            width={\"84%\"}\n        >\n            <Editor\n                value={value}\n                onValueChange={code => setValue(code)}\n                highlight={code => isHieghtlight ? highlight(code, languages.yaml, 'yaml') : code}\n                padding={10}\n                style={{\n                    fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n                    fontSize: 14,\n                    borderRadius: 5,\n                    backgroundColor: \"rgb(40, 44, 52)\",\n                    color: \"#ffffff\"\n                }}\n            />\n        </Drawer>\n    )\n}","import React, { useState, useEffect } from 'react';\nimport { Layout, Menu, Button, notification, Tag, message, Input, Checkbox, Badge } from 'antd'\nimport yaml from 'yaml'\nimport { get, all, create, put } from 'axios'\n\n\nimport SharedGroup from './components/sharedGroup'\nimport RawDrawer from './components/inputDrawer'\n\nimport { setCache, getCache } from \"./utils/cache\"\n\nimport './App.css';\n\nconst fileDownload = require('react-file-download')\n\nconst { Header, Content, Sider, Footer } = Layout;\n\nconst RAW_CONFIG = \"raw\"\nconst SUB_CONFIG = \"subs\"\nconst PROXIES_CONFIG = \"proxies\"\nconst IS_FLAT_RULESET = \"isFlatRules\"\nconst CLASHRESTFULAPI = \"clashAPI\"\n\nconst RULE_TYPES = [\"DOMAIN-SUFFIX\", \"DOMAIN-KEYWORD\", \"DOMAIN\", \"DOMAIN-SUFFIX\", \"IP-CIDR\", \"GEOIP\", \"FINAL\"]\n\nconst PROXY_KEY = \"proxies\"\nconst GROUP_KEY = \"proxy-groups\"\nconst RULE_KEY = \"rules\"\n\nconst localPort = 54637\nconst client = create({\n  baseURL: `http://127.0.0.1:${localPort}`,\n  headers: {\n    'content-type': 'application/x-www-form-urlencoded'\n  }\n})\n\nfunction App() {\n  const rawConfig = useDrawerInput({ title: \"Input raw config.yaml\", cacheKey: RAW_CONFIG })\n  const { 'setValue': setRawConfig, 'setVisible': setRawDrawerVisible } = rawConfig\n  const subsURLs = useDrawerInput({ title: \"Input subscriptions(.yaml) url line by line\", cacheKey: SUB_CONFIG })\n  const { 'setVisible': setSubDrawerVisible } = subsURLs\n  const [syncBtnLoading, setSyncBtnLoading] = useState(false)\n  const [groupIndex, setGroupIndex] = useState(\"0\")\n  const [moreFileterStr, setMoreFilterStr] = useState(\"\")\n\n  const [isLocalMode, setIsLocalMode] = useState(false)\n  useEffect(() => {\n    client.get('/ping').then(({ data = \"\", status }) => {\n      setIsLocalMode(status === 200 && data === \"pong\")\n    }).catch(_ => { })\n  }, [])\n\n  const [subProxies, setSubProxies] = useLocalStorage(PROXIES_CONFIG, [])\n  const [isFlatRuleset, setIsFlatRuleset] = useLocalStorage(IS_FLAT_RULESET, true)\n  const [clashAPI, setClashAPI] = useLocalStorage(CLASHRESTFULAPI, \"\")\n\n  const [rawObj, setRawObj] = useState({})\n  useEffect(() => {\n    let obj = {}\n    try {\n      obj = yaml.parse(rawConfig.value)\n\n      const { \"Rule\": rule, \"Proxy Group\": proxyGroup, \"Proxy\": proxy } = obj\n      if (rule || proxyGroup || proxy) {\n        notification.open({\n          message: 'Raw Config contains deprecated keys',\n          description: `Proxy|Proxy Group|Rule keys are not deprecated, change it to proxies|proxy-groups|rules`,\n          duration: 0,\n        })\n      }\n    } catch{ }\n    setRawObj(obj || {})\n  }, [rawConfig.value])\n\n  async function handleSyncProxies() {\n    const request = async url => {\n      try {\n        let resp = await get(url)\n        return resp.data\n      } catch {\n        return \"\"\n      }\n    }\n\n    setSyncBtnLoading(true)\n    try {\n      const OLD_PROXY_KEY = \"Proxy\"\n      const urls = subsURLs.value.split('\\n').filter(url => /^https?:\\/\\//.test(url))\n      const proxyURL = isLocalMode ? `http://127.0.0.1:${localPort}/proxy?url=` : \"https://cloudcompute.lbyczf.com/proxy-content?url=\"\n      const resps = await all(urls.map(url => request(`${proxyURL}${encodeURIComponent(url)}`)))\n      let proxies = []\n      resps.forEach((data, index) => {\n        if (data === \"\") {\n          notification.error({\n            message: \"Could not download from subscription\",\n            description: urls[index]\n          })\n          return\n        }\n        let yml = {}\n        try {\n          yml = yaml.parse(data)\n        } catch{ }\n        const { [PROXY_KEY]: p, [OLD_PROXY_KEY]: op = [] } = yml\n        proxies = proxies.concat(p || op)\n      })\n      setSubProxies(proxies)\n    } catch (e) {\n      notification.error({\n        message: \"Sync Error\",\n        description: e.stack,\n      })\n    }\n    setSyncBtnLoading(false)\n  }\n\n  function handleProxiesChange(order) {\n    let { [GROUP_KEY]: gs = [] } = rawObj\n    gs[groupIndex].proxies = order\n    const yml = yaml.stringify({ ...rawObj, [GROUP_KEY]: gs })\n    setRawConfig(yml)\n  }\n\n  function handleMoreFilterChange(e) {\n    const { value } = e.target\n    setMoreFilterStr(value)\n  }\n\n  function handleIsFlatRulesetChange(e) {\n    const { checked = true } = e.target\n    setIsFlatRuleset(checked)\n  }\n\n  function handleClashAPIChange(e) {\n    const { value = \"\" } = e.target\n    setClashAPI(value)\n  }\n\n  async function handleDownloadProfile() {\n    const { [PROXY_KEY]: proxies = [], [GROUP_KEY]: groups = [], [RULE_KEY]: rules = [] } = rawObj\n    let finalRules = []\n    for (let rule of rules) {\n      const ps = rule.split(',').map(p => p.trim())\n      const [type, url, proxy] = ps\n      if (type === 'RULE-SET' && isFlatRuleset) {\n        try {\n          const resp = await get(url)\n          const { status, data } = resp\n          if (status === 200) {\n            const lines = data.split('\\n')\n            finalRules = [...finalRules, ...lines.map(l => {\n              const [type, payload, args] = l.split(',').map(p => p.trim())\n              if (!RULE_TYPES.includes(type)) return null;\n              let res = `${type},${payload},${proxy}`\n              if (args === 'no-resolve') {\n                res += \",no-resolve\"\n              }\n              return res\n            }).filter(r => r)]\n          }\n        } catch {\n          notification.error({\n            message: \"Ruleset download failed\",\n            description: url\n          })\n          return\n        }\n      } else {\n        finalRules = [...finalRules, rule]\n      }\n    }\n    const finalProxies = proxies.concat(subProxies)\n    const allProxyNames = [\n      ...finalProxies.map(p => p.name),\n      ...groups.map(g => g.name),\n      ...[\"DIRECT\", \"REJECT\", \"GLOBAL\"]\n    ]\n    for (let [idx, g] of groups.entries()) {\n      const { proxies = [] } = g\n      for (let ps of proxies) {\n        if (!allProxyNames.includes(ps)) {\n          message.error(`Group [${g.name}] contains a not exist proxy [${ps}]`, 5)\n          setGroupIndex(idx + \"\")\n          return\n        }\n      }\n    }\n    const fileName = 'config.yml'\n    const fileContent = yaml.stringify({ ...rawObj, [PROXY_KEY]: finalProxies, [RULE_KEY]: finalRules })\n    if (isLocalMode) {\n      const { 'status': s } = await client({\n        method: \"post\",\n        url: \"/config\",\n        data: \"config=\" + encodeURIComponent(fileContent)\n      })\n      if (s === 204) {\n        window.location.href = `clash://install-config?url=${encodeURIComponent(`http://127.0.0.1:${localPort}/config`)}`\n      }\n    } else if (clashAPI) {\n      try {\n        await put(`${clashAPI}/configs`, { payload: fileContent }, { validateStatus: s => s !== 200 })\n        notification.success({\n          message: \"Done\",\n          description: \"Enjoy your free time.\"\n        })\n      } catch (e) {\n        notification.info({\n          message: \"Could not write profile to Clash\",\n          description: e.stack\n        })\n      }\n    } else {\n      fileDownload(fileContent, fileName)\n    }\n  }\n\n  const { [GROUP_KEY]: gs = [], [PROXY_KEY]: ps = [] } = rawObj\n  const proxyGroupNames = gs.map((g, idx) => {\n    return (\n      <Menu.Item key={idx}>{g.name}</Menu.Item>\n    )\n  })\n\n  let groupProxies = []\n  if (groupIndex < gs.length) {\n    const { proxies = [] } = gs[groupIndex * 1]\n    groupProxies = proxies\n  }\n\n  const moreProxies = [\n    'DIRECT',\n    'GLOBAL',\n    'REJECT',\n    ...gs.map(g => g.name),\n    ...ps.map(p => p.name),\n    ...subProxies.map(p => p.name)\n  ].filter(p => {\n    let exp = /^/\n    try {\n      exp = new RegExp(moreFileterStr)\n    } catch { }\n    return !groupProxies.includes(p) && exp.test(p)\n  })\n\n  return (\n    <Layout className=\"main\">\n      <Header className=\"header\">\n        <Menu\n          theme=\"dark\"\n          mode=\"horizontal\"\n          selectedKeys={['1']}\n          style={{ lineHeight: '64px' }}\n        >\n          <Menu.Item key=\"1\">Proxy Group</Menu.Item>\n          <Menu.Item key=\"2\" onClick={() => setRawDrawerVisible(true)}>Raw Config</Menu.Item>\n          <Menu.Item key=\"3\" onClick={() => setSubDrawerVisible(true)}>Subscription</Menu.Item>\n          <Menu.Item key=\"4\" onClick={() => window.open(\"https://github.com/Fndroid/clash-config-builder\", \"_blank\")}>Github</Menu.Item>\n        </Menu>\n      </Header>\n      <Layout>\n        <Sider width={200} style={{ background: '#fff' }}>\n          <Menu\n            mode=\"inline\"\n            selectedKeys={[groupIndex]}\n            onClick={(item) => setGroupIndex(item.key)}\n            style={{ height: '100%', borderRight: 0 }}\n          >\n            {proxyGroupNames}\n          </Menu>\n        </Sider>\n        <Layout style={{ padding: '0 24px 24px' }}>\n          <Content\n            className=\"content\"\n          >\n            <div className=\"list\">\n              <Badge count={groupProxies.length} overflowCount={2000} offset={[20, 0]} style={{ backgroundColor: '#f50' }}>\n                <div className=\"list-title\">Proxies</div>\n              </Badge>\n              {/* <Empty hidden={groupProxies.length !== 0} /> */}\n              <SharedGroup\n                items={groupProxies}\n                onChange={handleProxiesChange}\n              />\n            </div>\n\n            <div className=\"list\">\n              <Badge count={moreProxies.length} overflowCount={2000} offset={[20, 0]} style={{ backgroundColor: '#52c41a' }}>\n                <div className=\"list-title\">More</div>\n              </Badge>\n              <SharedGroup\n                items={moreProxies}\n                onChange={() => { }}\n              />\n              <Input\n                className=\"filter-input\"\n                placeholder=\"flter by regular expression\"\n                value={moreFileterStr}\n                onChange={handleMoreFilterChange}\n                allowClear\n              ></Input>\n            </div>\n\n          </Content>\n        </Layout>\n      </Layout>\n      <Footer className=\"footer\">\n        <Button className=\"btn\" loading={syncBtnLoading} icon=\"cloud-download\" onClick={handleSyncProxies}>Sync Proxies</Button>\n        <Button className=\"btn\" type=\"primary\" icon=\"download\" onClick={handleDownloadProfile}>Download Profile</Button>\n        <Checkbox className='btn' checked={isFlatRuleset} onChange={handleIsFlatRulesetChange}>Flat Ruleset</Checkbox>\n        <Tag className=\"btn mode-tag\" color={isLocalMode ? \"green\" : \"volcano\"}>{`${isLocalMode ? \"Local\" : \"Remote\"} Mode`}</Tag>\n        <Input value={clashAPI} className=\"input\" placeholder=\"http://127.0.0.1:9090\" onChange={handleClashAPIChange} ></Input>\n      </Footer>\n      <RawDrawer\n        {...rawConfig}\n      ></RawDrawer>\n      <RawDrawer\n        {...subsURLs}\n        isHieghtlight={false}\n      ></RawDrawer>\n    </Layout>\n  );\n}\n\nfunction useLocalStorage(key, initValue) {\n  const c = getCache(key)\n  const [value, setValue] = useState(c === null ? initValue : c)\n\n  function setValueCache(val) {\n    setValue(val)\n    setCache(key, val)\n  }\n\n  return [value, setValueCache]\n}\n\nfunction useDrawerInput({ title, initValue = \"\", cacheKey }) {\n  const [value, setValue] = useLocalStorage(cacheKey, initValue)\n  const [visible, setVisible] = useState(false)\n\n  function handleChange(t) {\n    setVisible(false)\n    setValue(t)\n  }\n\n  return {\n    title,\n    visible,\n    value,\n    onChange: handleChange,\n    setValue,\n    setVisible,\n  }\n}\n\n\nexport default App;\n","function setCache(key, value) {\n    window.localStorage.setItem(key, JSON.stringify(value))\n}\n\nfunction getCache(key) {\n    const str = window.localStorage.getItem(key)\n    try {\n        const obj = JSON.parse(str)\n        return obj\n    } catch{ }\n    return str\n}\n\nexport {\n    setCache,\n    getCache\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}