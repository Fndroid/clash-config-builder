(this["webpackJsonpclash-config-builder"]=this["webpackJsonpclash-config-builder"]||[]).push([[0],{153:function(e,t,a){e.exports=a(287)},158:function(e,t,a){},268:function(e,t,a){},287:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(12),o=a.n(c),i=(a(158),a(159),a(144)),s=a(43),u=a.n(s),l=(a(162),a(151)),p=(a(164),a(150)),f=(a(113),a(65)),m=(a(167),a(111)),b=(a(169),a(112)),d=a(44),v=(a(288),a(52)),h=a(72),g=a(90),y=(a(173),a(57)),O=a(27),x=(a(175),a(51)),j=a(73),k=a(67),E=a(139),w=a.n(E),C=a(140),I=a.n(C),S=function(e){var t=e.items,a=void 0===t?[]:t,n=e.onChange,c=void 0===n?function(){}:n,o=a.map((function(e){return r.a.createElement("div",{className:"menu-item",key:I()(),"data-id":e},e)}));return r.a.createElement(w.a,{options:{group:"shared",animation:150},onChange:c,className:"menu"},o)},N=(a(219),a(149)),R=a(141),P=a.n(R),D=a(109),F=(a(221),a(222),a(223),function(e){var t=e.title,a=void 0===t?"":t,c=e.visible,o=void 0!==c&&c,i=e.onChange,s=e.value,u=e.isHieghtlight,l=void 0===u||u,p=Object(n.useState)(s),f=Object(O.a)(p,2),m=f[0],b=f[1];return Object(n.useEffect)((function(){b(s)}),[s]),r.a.createElement(N.a,{title:a,placement:"right",onClose:function(){return i(m)},visible:o,width:"84%"},r.a.createElement(P.a,{value:m,onValueChange:function(e){return b(e)},highlight:function(e){return l?Object(D.highlight)(e,D.languages.yaml,"yaml"):e},padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:14,borderRadius:5,backgroundColor:"rgb(40, 44, 52)",color:"#ffffff"}}))});a(268);function A(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function G(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?A(a,!0).forEach((function(t){Object(h.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):A(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L=a(269),M=x.a.Header,U=x.a.Content,V=x.a.Sider,J=x.a.Footer,K="raw",T="subs",H="proxies",z="isFlatRules",B="clashAPI",X=["DOMAIN-SUFFIX","DOMAIN-KEYWORD","DOMAIN","DOMAIN-SUFFIX","IP-CIDR","GEOIP","FINAL"],Y="proxies",W="proxy-groups",_="rules",q=54637,Q=Object(k.create)({baseURL:"http://127.0.0.1:".concat(q),headers:{"content-type":"application/x-www-form-urlencoded"}});function Z(e,t){var a=function(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t)}catch(a){}return t}(e),r=Object(n.useState)(null===a?t:a),c=Object(O.a)(r,2),o=c[0],i=c[1];return[o,function(t){i(t),function(e,t){window.localStorage.setItem(e,JSON.stringify(t))}(e,t)}]}function $(e){var t=e.title,a=e.initValue,r=void 0===a?"":a,c=Z(e.cacheKey,r),o=Object(O.a)(c,2),i=o[0],s=o[1],u=Object(n.useState)(!1),l=Object(O.a)(u,2),p=l[0],f=l[1];return{title:t,visible:p,value:i,onChange:function(e){f(!1),s(e)},setValue:s,setVisible:f}}var ee=function(){var e=$({title:"Input raw config.yaml",cacheKey:K}),t=e.setValue,a=e.setVisible,c=$({title:"Input subscriptions(.yaml) url line by line",cacheKey:T}),o=c.setVisible,s=Object(n.useState)(!1),E=Object(O.a)(s,2),w=E[0],C=E[1],I=Object(n.useState)("0"),N=Object(O.a)(I,2),R=N[0],P=N[1],D=Object(n.useState)(""),A=Object(O.a)(D,2),ee=A[0],te=A[1],ae=Object(n.useState)(!1),ne=Object(O.a)(ae,2),re=ne[0],ce=ne[1];Object(n.useEffect)((function(){Q.get("/ping").then((function(e){var t=e.data,a=void 0===t?"":t,n=e.status;ce(200===n&&"pong"===a)})).catch((function(e){}))}),[]);var oe=Z(H,[]),ie=Object(O.a)(oe,2),se=ie[0],ue=ie[1],le=Z(z,!0),pe=Object(O.a)(le,2),fe=pe[0],me=pe[1],be=Z(B,""),de=Object(O.a)(be,2),ve=de[0],he=de[1],ge=Object(n.useState)({}),ye=Object(O.a)(ge,2),Oe=ye[0],xe=ye[1];function je(){return(je=Object(g.a)(u.a.mark((function e(){var t,a,n,r,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){var e=Object(g.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(k.get)(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return","");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),C(!0),e.prev=2,a="Proxy",n=c.value.split("\n").filter((function(e){return/^https?:\/\//.test(e)})),r=re?"http://127.0.0.1:".concat(q,"/proxy?url="):"https://cloudcompute.lbyczf.com/proxy-content?url=",e.next=8,Object(k.all)(n.map((function(e){return t("".concat(r).concat(encodeURIComponent(e)))})));case 8:o=e.sent,i=[],o.forEach((function(e,t){if(""!==e){var r={};try{r=j.a.parse(e)}catch(l){}var c=r,o=c[Y],s=c[a],u=void 0===s?[]:s;i=i.concat(o||u)}else y.a.error({message:"Could not download from subscription",description:n[t]})})),ue(i),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),y.a.error({message:"Sync Error",description:e.t0.stack});case 17:C(!1);case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))).apply(this,arguments)}function ke(){return(ke=Object(g.a)(u.a.mark((function e(){var t,a,n,r,c,o,s,l,p,f,m,b,v,g,x,E,w,C,I,S,N,R,D,F,A,M,U,V,J,K,T,H,z,B,Z,$,ee;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=Oe[Y],n=void 0===a?[]:a,r=Oe[W],c=void 0===r?[]:r,o=Oe[_],s=void 0===o?[]:o,l=[],p=!0,f=!1,m=void 0,e.prev=5,b=u.a.mark((function e(){var t,a,n,r,c,o,i,s,p,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=g.value,a=t.split(",").map((function(e){return e.trim()})),n=Object(O.a)(a,3),r=n[0],c=n[1],o=n[2],"RULE-SET"!==r||!fe){e.next=18;break}return e.prev=4,e.next=7,Object(k.get)(c);case 7:i=e.sent,s=i.status,p=i.data,200===s&&(f=p.split("\n"),l=[].concat(Object(d.a)(l),Object(d.a)(f.map((function(e){var t=e.split(",").map((function(e){return e.trim()})),a=Object(O.a)(t,3),n=a[0],r=a[1],c=a[2];if(!X.includes(n))return null;var i="".concat(n,",").concat(r,",").concat(o);return"no-resolve"===c&&(i+=",no-resolve"),i})).filter((function(e){return e}))))),e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(4),y.a.error({message:"Ruleset download failed",description:c}),e.abrupt("return",{v:void 0});case 16:e.next=19;break;case 18:l=[].concat(Object(d.a)(l),[t]);case 19:case"end":return e.stop()}}),e,null,[[4,12]])})),v=s[Symbol.iterator]();case 8:if(p=(g=v.next()).done){e.next=16;break}return e.delegateYield(b(),"t0",10);case 10:if("object"!==typeof(x=e.t0)){e.next=13;break}return e.abrupt("return",x.v);case 13:p=!0,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(5),f=!0,m=e.t1;case 22:e.prev=22,e.prev=23,p||null==v.return||v.return();case 25:if(e.prev=25,!f){e.next=28;break}throw m;case 28:return e.finish(25);case 29:return e.finish(22);case 30:E=n.concat(se),w=[].concat(Object(d.a)(E.map((function(e){return e.name}))),Object(d.a)(c.map((function(e){return e.name}))),["DIRECT","REJECT","GLOBAL"]),C=!0,I=!1,S=void 0,e.prev=35,N=c.entries()[Symbol.iterator]();case 37:if(C=(R=N.next()).done){e.next=74;break}D=R.value,F=Object(O.a)(D,2),A=F[0],M=F[1],U=M.proxies,V=void 0===U?[]:U,J=!0,K=!1,T=void 0,e.prev=46,H=V[Symbol.iterator]();case 48:if(J=(z=H.next()).done){e.next=57;break}if(B=z.value,w.includes(B)){e.next=54;break}return i.a.error("Group [".concat(M.name,"] contains a not exist proxy [").concat(B,"]"),5),P(A+""),e.abrupt("return");case 54:J=!0,e.next=48;break;case 57:e.next=63;break;case 59:e.prev=59,e.t2=e.catch(46),K=!0,T=e.t2;case 63:e.prev=63,e.prev=64,J||null==H.return||H.return();case 66:if(e.prev=66,!K){e.next=69;break}throw T;case 69:return e.finish(66);case 70:return e.finish(63);case 71:C=!0,e.next=37;break;case 74:e.next=80;break;case 76:e.prev=76,e.t3=e.catch(35),I=!0,S=e.t3;case 80:e.prev=80,e.prev=81,C||null==N.return||N.return();case 83:if(e.prev=83,!I){e.next=86;break}throw S;case 86:return e.finish(83);case 87:return e.finish(80);case 88:if(Z="config.yml",$=j.a.stringify(G({},Oe,(t={},Object(h.a)(t,Y,E),Object(h.a)(t,_,l),t))),!re){e.next=98;break}return e.next=93,Q({method:"post",url:"/config",data:"config="+encodeURIComponent($)});case 93:ee=e.sent,204===ee.status&&(window.location.href="clash://install-config?url=".concat(encodeURIComponent("http://127.0.0.1:".concat(q,"/config")))),e.next=111;break;case 98:if(!ve){e.next=110;break}return e.prev=99,e.next=102,Object(k.put)("".concat(ve,"/configs"),{payload:$},{validateStatus:function(e){return 200!==e}});case 102:y.a.success({message:"Done",description:"Enjoy your free time."}),e.next=108;break;case 105:e.prev=105,e.t4=e.catch(99),y.a.info({message:"Could not write profile to Clash",description:e.t4.stack});case 108:e.next=111;break;case 110:L($,Z);case 111:case"end":return e.stop()}}),e,null,[[5,18,22,30],[23,,25,29],[35,76,80,88],[46,59,63,71],[64,,66,70],[81,,83,87],[99,105]])})))).apply(this,arguments)}Object(n.useEffect)((function(){var t={};try{var a=t=j.a.parse(e.value),n=a.Rule,r=a["Proxy Group"],c=a.Proxy;(n||r||c)&&y.a.open({message:"Raw Config contains deprecated keys",description:"Proxy|Proxy Group|Rule keys are not deprecated, change it to proxies|proxy-groups|rules",duration:0})}catch(o){}xe(t||{})}),[e.value]);var Ee=Oe[W],we=void 0===Ee?[]:Ee,Ce=Oe[Y],Ie=void 0===Ce?[]:Ce,Se=we.map((function(e,t){return r.a.createElement(v.a.Item,{key:t},e.name)})),Ne=[];if(R<we.length){var Re=we[1*R].proxies;Ne=void 0===Re?[]:Re}var Pe=["DIRECT","GLOBAL","REJECT"].concat(Object(d.a)(we.map((function(e){return e.name}))),Object(d.a)(Ie.map((function(e){return e.name}))),Object(d.a)(se.map((function(e){return e.name})))).filter((function(e){var t=/^/;try{t=new RegExp(ee)}catch(a){}return!Ne.includes(e)&&t.test(e)}));return r.a.createElement(x.a,{className:"main"},r.a.createElement(M,{className:"header"},r.a.createElement(v.a,{theme:"dark",mode:"horizontal",selectedKeys:["1"],style:{lineHeight:"64px"}},r.a.createElement(v.a.Item,{key:"1"},"Proxy Group"),r.a.createElement(v.a.Item,{key:"2",onClick:function(){return a(!0)}},"Raw Config"),r.a.createElement(v.a.Item,{key:"3",onClick:function(){return o(!0)}},"Subscription"),r.a.createElement(v.a.Item,{key:"4",onClick:function(){return window.open("https://github.com/Fndroid/clash-config-builder","_blank")}},"Github"))),r.a.createElement(x.a,null,r.a.createElement(V,{width:200,style:{background:"#fff"}},r.a.createElement(v.a,{mode:"inline",selectedKeys:[R],onClick:function(e){return P(e.key)},style:{height:"100%",borderRight:0}},Se)),r.a.createElement(x.a,{style:{padding:"0 24px 24px"}},r.a.createElement(U,{className:"content"},r.a.createElement("div",{className:"list"},r.a.createElement(b.a,{count:Ne.length,overflowCount:2e3,offset:[20,0],style:{backgroundColor:"#f50"}},r.a.createElement("div",{className:"list-title"},"Proxies")),r.a.createElement(S,{items:Ne,onChange:function(e){var a=Oe[W],n=void 0===a?[]:a;n[R].proxies=e;var r=j.a.stringify(G({},Oe,Object(h.a)({},W,n)));t(r)}})),r.a.createElement("div",{className:"list"},r.a.createElement(b.a,{count:Pe.length,overflowCount:2e3,offset:[20,0],style:{backgroundColor:"#52c41a"}},r.a.createElement("div",{className:"list-title"},"More")),r.a.createElement(S,{items:Pe,onChange:function(){}}),r.a.createElement(m.a,{className:"filter-input",placeholder:"flter by regular expression",value:ee,onChange:function(e){var t=e.target.value;te(t)},allowClear:!0}))))),r.a.createElement(J,{className:"footer"},r.a.createElement(f.a,{className:"btn",loading:w,icon:"cloud-download",onClick:function(){return je.apply(this,arguments)}},"Sync Proxies"),r.a.createElement(f.a,{className:"btn",type:"primary",icon:"download",onClick:function(){return ke.apply(this,arguments)}},"Download Profile"),r.a.createElement(p.a,{className:"btn",checked:fe,onChange:function(e){var t=e.target.checked;me(void 0===t||t)}},"Flat Ruleset"),r.a.createElement(l.a,{className:"btn mode-tag",color:re?"green":"volcano"},"".concat(re?"Local":"Remote"," Mode")),r.a.createElement(m.a,{value:ve,className:"input",placeholder:"http://127.0.0.1:9090",onChange:function(e){var t=e.target.value;he(void 0===t?"":t)}})),r.a.createElement(F,e),r.a.createElement(F,Object.assign({},c,{isHieghtlight:!1})))};o.a.render(r.a.createElement(ee,null),document.getElementById("root"))}},[[153,1,2]]]);
//# sourceMappingURL=main.7c2d065d.chunk.js.map